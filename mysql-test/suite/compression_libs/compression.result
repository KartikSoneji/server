# Testing all compression libraries


#
# Test --use-compression=lzma on storage engine "innodb"
#
# Start server with default options (lzma enabled)
# restart: --use-compression=lzma
DROP TABLE IF EXISTS lzma;
SET GLOBAL innodb_compression_algorithm = lzma;
CREATE TABLE lzma (
a int,
b char(20) 
)
engine = innodb
page_compressed = 1
;
INSERT INTO lzma (a, b) VALUES (0, "abc");
INSERT INTO lzma (a, b) VALUES (1, "def");
INSERT INTO lzma (a, b) VALUES (2, "ghi");
SELECT * FROM lzma;
a	b
0	abc
1	def
2	ghi
# Start server with no libraries
# restart: --use_compression=
# Table should not exist, as server does not know how to read compressed data
SELECT * FROM lzma;
ERROR 42S02: Table 'test.lzma' doesn't exist in engine
DROP TABLE lzma;
# restart
