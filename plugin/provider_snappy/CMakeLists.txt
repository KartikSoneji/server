CHECK_INCLUDE_FILES(snappy-c.h HAVE_SNAPPY_H)
CHECK_LIBRARY_EXISTS(snappy snappy_uncompress "" HAVE_SNAPPY_UNCOMPRESS)

IF (HAVE_SNAPPY_H AND HAVE_SNAPPY_UNCOMPRESS)
  GET_PROPERTY(dirs DIRECTORY PROPERTY INCLUDE_DIRECTORIES)
  LIST(REMOVE_ITEM dirs ${CMAKE_SOURCE_DIR}/include/wrappers)
  SET_PROPERTY(DIRECTORY PROPERTY INCLUDE_DIRECTORIES "${dirs}")

  MYSQL_ADD_PLUGIN(provider_snappy plugin.c MODULE_OUTPUT_NAME provider_snappy
    COMPONENT provider_snappy LINK_LIBRARIES snappy CONFIG provider_snappy.cnf)
ENDIF()
